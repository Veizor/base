language: bash
services: docker

env:
  global:
  - secure: aUwzXhIMi3Q8jElOsDGjS0yftnv/8NrBefpmFJt70wmojFZjPtDG854OKmAbFsD/Vnnossv9H3mNHcM0xKXaPsX7I3hcaxrC8XsGiyfo+JEAaZZCAdT0uEoUKhKmxyl5wP34K4S0OLgHgShOTWtV3RKggEYjpx5op76R9f+jFkn86RMqSm6Yj+0MSFqbx+zXClpOBWFStRpsOGgR1kyeuR/ddkU8lFb4aLRszMtkfup4LPIr0NyRchb8pKrl4lQm0kEcqn1TSCY0iflRcSnNHlYj7CBHNdTXR0O8BtpO5YtmYK+yi8/tdGMRDQqrXy+g1EpBk+sPBNBhKRIoXApuCAu4Fimw2P3Bd0sr4wYfznQqwYTVX0BOHLNSp4h1OIrsvAJ9phUOSp6FZarxCiB5coZA9R8iJdl1AGDV3dZKIYAaaG31C5TYRWfz0K8QazIK72sXHeHCUy1iE4px4fTJiTmin4Y5NjZPXmdUfNEH9AcvUcC3X5zavw/3BDqAvAy++11sRTA//ITa6qnFXisNvgHWLxtLQVn0gQ2IleN6R6+OOfDqEp37vhTSpgLsTjK3T7PODaANEy2c5Y/mXDYh26dzACNrCXcyvPr/vbbca/2kKYXcqzADWIuUnACN5VP1DkSWsnj1BpqjHS/cGrjgQgxntO8FCvQnJVyci2Gl5ds=
  - secure: AyxELSbOawZdPvLh4E2s7lcMYvyCmwWbsQFhK5lTmxrJuGEE+g9bV18LZ+1ZLAN7MxNONaG1E6lxfjwFqbiH6sYG1E9md9DwZIEozoIpwmLYjHMz8ZtVd4SwGM/HktTIAiv+OLqZ0ggvR/6mQKxLaML2MJ2EHBuU9hM1fArdeGvrslx2rDss5uqQbE2Jd8LplXo2rRxmd2z9ErAhMjPWQqVzhl5UyiOAvhkocz2MkoqpWGbXuS9cgW4alZThqps/zJicma+Cz0nrPUr5ebFSt2wfbInurtkEW4+Gfj453Bk6WJTGzhbEzVHbay5M2BEybCHyVK/GmQzjruLUmoZjs1e5A4Dc6z9KHZBbErcJmG2SH9LDcirnvctA0DM+Kkk3972DTJ7ibs+KQ/fw1iFXimtasZYJ86NFoPcTkcO6bl/gqLu748UwkKtV1c7Y9nT1jm9tAl3Idz+I4xVv1B9N2RPNaD+wVt98zmzFnUYh28d3ZmMJ9gbWNm8TzNQA053ODMVbEviQ/4592LF/7J9rqJfZ3/o+hvSFvlGntqsa2l+yjaOpFB4kmfr41zN4jd9ZGH17pqxJF+BSoLkvX7bDv4OhLoB6fEaAIFGm7lPkw9/gcQFrwRP0vUxNJ+DajCeTkWV6gwEpRQEbYX6iczgXxQV5IeBusOWdTaEImZ9fahQ=
  - secure: grJBGw8dgrVDLOzaKynMkhCAhaYc//7sk4O7LaZ+0UMIDmAnWqRXjntFWEqpmpxZ7H9yTX2qarInXhUAVrGvJkAVJyPCvKuShnP9GFdeV1uvZ6eZZglX6O3FU32hDiL33sRz9SDhyaPAFiNfHISnXWcuzg36PeE7eDG6bu4TTrh/31wiOjCTZDWSLAuHNuLTKJEnBizf2QgzEhTjD3OlsptkYWnKqrWcxoTesWHkvYKN0RFx64kbSdNjKK/AZ9PUAGNZvLkboEJiFdhaQOfQmBgMhtK0VW3Ej4xio0oUXpWe5vTm4PUStSH8aE71fyknCInxM728K9ByjZWgmTjck/18flIy+MgRSxR2kvPM1IdzjrTLedWQHIXHH3mWIAi+SIqvmFT6q16WXc1rrhu3Ee+DQvciTQy+MBaOBGq7hDAfQu+uWqV5HyvPuQh4y3r7EE1AQVsgDdGMhM766vSIkoVuq+Y3C3GRvcRpYE8upCFMJS6FiKSq3fokVPrBJAJ78VRNVPjsVmrubco89Jy38K/gLV8ZL+uAsF0neQc4nys5HH9uKC/mhRDPGPMeT+b1SjCCl2s+S6kK702C1kVeehAu9zrIWd6SkMvE7kL3l5MXcAjyclZLy7C9Iz8iNzrqNJmYXHJ+X0kAuLG0pRibtw0Mqbg0hoOYi47W9xQZpT0=

script:
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH; fi`
  - docker build -f Dockerfile -t ${TRAVIS_REPO_SLUG,,}:$TAG .

after_success:
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
  - docker tag ${TRAVIS_REPO_SLUG,,}:$TAG ${TRAVIS_REPO_SLUG,,}:travis-$TRAVIS_BUILD_NUMBER
  - docker push ${TRAVIS_REPO_SLUG,,}
